localization_node:
  ros__parameters:
    # Map file path (required)
    map_path: ""

    # Voxel size for fine registration (meters) - reference uses 0.05
    voxel_size_fine: 0.05

    # Localization frequency (Hz)
    loc_frequency: 2.0

    # Fitness threshold for accepting registration result (0-1)
    # Higher = more strict, lower = more permissive
    fitness_threshold: 0.5

    # Submap radius for cropping (meters)
    # Larger = more context but slower
    submap_radius: 50.0

    # Maximum points for source (scan) cloud
    max_points_source: 100000

    # Maximum points for target (map) cloud
    max_points_target: 500000

    # Initial pose [x, y, z, roll, pitch, yaw] (degrees for rotation)
    # If near origin (0,0,0), global localization will be attempted
    initial_pose: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0]

    # Global localization (FPFH + RANSAC)
    # Automatically finds initial pose without user input
    use_global_localization: true
    voxel_size_global: 0.25         # For FPFH feature extraction (larger = more robust for indoor)
    fitness_threshold_global: 0.15  # Threshold for accepting global localization

    # Kalman filter parameters [process_variance, measurement_variance]
    # Lower process_var = smoother, higher = more responsive
    # Lower meas_var = trust measurements more
    # Z-axis typically uses tighter params to reduce height jitter
    kalman_x: [0.001, 0.002]
    kalman_y: [0.001, 0.005]
    kalman_z: [0.00001, 0.04]

    # Distance-based submap update (meters)
    # Only recompute submap when robot moves more than this distance
    # Reduces computation when stationary or moving slowly
    dis_updatemap: 3.0

    # Point cloud queue size
    # Number of scans to accumulate for denser point cloud
    pcd_queue_maxsize: 5

    # Debug options
    save_scan: false
    save_scan_path: "/tmp/localization_scans/"

    # TF frame names
    # TF tree: map -> odom -> base_link
    # Localization broadcasts: map -> odom
    # FAST-LIO Mapping broadcasts: odom -> base_link
    map_frame: "map"
    odom_frame: "odom"
    body_frame: "base_link"

    # OccupancyGrid generation from loaded PCD map
    # Published once at startup with transient_local QoS
    occupancy_grid:
      publish: true           # Enable/disable OccupancyGrid publishing
      resolution: 0.05        # Grid cell size in meters
      z_min: -0.5             # Minimum Z height to include (meters)
      z_max: 1.5              # Maximum Z height to include (meters)
